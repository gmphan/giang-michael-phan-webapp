@model Project3LayerView

<div class="card-body">
    <div class="card mb-3">
        <form method="post" action="/YourController/YourAction">
            <div class="p-1 mt-2">
                <div class="row mb-1 p-0">
                    <div class="d-flex align-items-center">
                        <label asp-for="SelectedTaskId" class="me-2" style="min-width: 150px;">Tasks</label>
                        <select asp-for="SelectedTaskId" class="form-select form-control flex-grow-1" id="taskDropdown">
                            <option value="">---Select a task---</option>
                            @foreach (var task in Model.ProjectTasks)
                            {
                                <option value="@task.Id"
                                        data-activities="@Html.Raw(Json.Serialize(task.ProjectTaskActivities))">
                                    @task.ProjectTaskName
                                </option>
                            }
                        </select>
                    </div>
                </div>

                <!-- Activity Details -->
                <div class="p-1 mt-2">
                    <div class="row mb-1 p-0">
                        <div class="d-flex align-items-center">
                            <label for="taskActivity" class="me-2" style="min-width: 150px;">Task Activities</label>
                        </div>
                        <ul id="taskActivityList" class="list-group">
                            <!-- This will be dynamically filled with activity details -->
                        </ul>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Submit</button>
            </div>
        </form>
    </div>
</div>

<!-- JavaScript to handle dropdown selection and update fields -->
<script>
    document.getElementById('taskDropdown').addEventListener('change', function () {
        var selectedOption = this.options[this.selectedIndex];

        // Update the task activity details
        var activities = JSON.parse(selectedOption.getAttribute('data-activities'));
        var activityList = document.getElementById('taskActivityList');
        activityList.innerHTML = ''; // Clear previous activities

        activities.forEach(function(activity) {
            var listItem = document.createElement('li');
            listItem.className = "list-group-item";
            listItem.textContent = activity.ActivityNote || 'No activity note available';
            activityList.appendChild(listItem);
        });
    });
</script>