
@model ProjectView
@{
    var tasks = Model.ProjectTasks;
    @* var activities = Model.ProjectTaskActivities; *@
}
<div class="card-body">
    <!-- Task Selection Dropdown -->
    <div class="card mb-3">
        <form action="post">
            <div class="p-1 mt-2">
                <div class="row mb-1 p-0">
                    <div class="d-flex align-items-center">
                        <label for="SelectedTaskId" class="me-2" style="min-width: 150px;">Task</label>
                        <select id="taskSelect" for="SelectedTaskId" class="form-select form-control flex-grow-1" id="taskDropdown">
                            <option value="">---Select a Task---</option>
                            @foreach(var task in tasks)
                            {
                                <option value="@task.Id"
                                    data-task-name="@task.ProjectTaskName"
                                    data-task-description="@task.ProjectTaskDescription"
                                    data-task-state="@task.ProjectTaskState"
                                    data-start-date="@task.ProjectTaskStartDate.ToString("MM/dd/yyyy")"
                                    data-due-date="@task.ProjectTaskDueDate.ToString("MM/dd/yyyy")"
                                    data-completed-date="@task.ProjectTaskCompletedDate?.ToString("MM/dd/yyyy")"
                                    >
                                    @task.ProjectTaskName
                                </option>
                                <!-- Store task activities in a hidden script tag as a JSON object. 
                                    DO NOT directly add data-activities to option above, the JSON will not work.
                                -->
                                <script id="task-activities-@task.Id" type="application/json">
                                    @Html.Raw(System.Text.Json.JsonSerializer.Serialize(task.ProjectTaskActivities.Select(a => new { a.ActivityNote, CreatedDate = a.CreatedDate.ToString("MM/dd/yyyy") }).ToList()))
                                </script>
                            }
                        </select>
                    </div>
                </div>
            </div>
            <!-- Task Details and Activities -->
            <div id="taskDetails">
                <div class="p-1">
                    <div class="row mb-3 p-1">
                        <div class="d-flex align-items-center">
                            <label for="Description" class="me-2" style="min-width: 150px;">Description</label>
                            <textarea id="taskDescription" class="form-control flex-grow-1" rows="4" placeholder="Project Description" readonly></textarea>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-1">
                <div class="row mb-1 p-1">
                    <div class="col-md-6">
                        <div class="d-flex align-items-center mb-3">
                            <label for="taskState" class="me-2" style="min-width: 150px;">Task State</label>
                            <div class="col-md-6"> <!-- Adjust the column width as needed -->
                                <select id="taskState" for="taskState" class="form-select form-control" disabled>
                                    <option value="">Select a state</option>
                                    <option value="WorkingInProgress">Working in Progress</option>
                                    <option value="Waiting">Waiting</option>
                                    <option value="OnHold">On Hold</option>
                                    <option value="Complete">Complete</option>
                                    <option value="Canceled">Canceled</option>
                                </select>
                            </div>
                        </div>
                        <div class="d-flex align-items-center">
                            <label for="startDate" class="me-2" style="min-width: 150px;">Start Date</label>
                            <!-- HTML for Datepicker -->
                            <div class="col-md-6">
                                <div class="input-group date">
                                    <input id="startDate" for="startDate" type="date" class="form-control" placeholder="mm/dd/yyyy" readonly/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right side with DueDate and CompletedDate -->
                    <div class="col-md-6">
                        <div class="d-flex align-items-center mb-3 justify-content-end">
                            <label for="dueDate" class="me-2" style="min-width: 150px;">Due Date</label>
                            <div class="col-md-6">
                                <div class="input-group date">
                                    <input id="dueDate" for="dueDate" type="date" class="form-control" placeholder="mm/dd/yyyy" />
                                </div>
                            </div>
                        </div>
                        

                        <div class="d-flex align-items-center justify-content-end">
                            <label for="completedDate" class="me-2" style="min-width: 150px;">Completed Date</label>
                            <div class="col-md-6">
                                <div class="input-group date">
                                    <input id="completedDate" for="completedDate" type="date" class="form-control" placeholder="mm/dd/yyyy" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
        </form>
    </div>


    <div class="mb-3">
        

         <!-- Task Details and Activities -->
        <div id="taskDetails" class="mb-3" style="">
            <h4 id="taskName"></h4>
            <p id="taskDescription"></p>
            <p><strong>Task State:</strong> <span id="taskState"></span></p>
            <p><strong>Start Date:</strong> <span id="startDate"></span></p>
            <p><strong>Due Date:</strong> <span id="dueDate"></span></p>
            <p><strong>Completed Date:</strong> <span id="completedDate"></span></p>

            <h5>Activities</h5>
            <ul id="activitiesList" class="list-group"></ul>
        </div>
    </div>
</div>